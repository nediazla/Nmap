# Técnicas de escaneo de puertos
Como novato en la reparación de automóviles, puedo luchar durante horas tratando de adaptar mis herramientas rudimentarias (martillo, cinta adhesiva, llave inglesa, etc.) a la tarea que tengo entre manos. Cuando fallo estrepitosamente y remolque mi cacharro a un mecánico real, él invariablemente busca en una enorme caja de herramientas hasta sacar el artilugio perfecto que hace que el trabajo parezca sin esfuerzo. El arte del escaneo de puertos es similar. Los expertos comprenden las docenas de técnicas de escaneo y eligen la adecuada (o combinación) para una tarea determinada. Los usuarios inexpertos y los script kiddies, por otro lado, intentan resolver todos los problemas con el escaneo SYN predeterminado. Dado que Nmap es gratuito, la única barrera para dominar el escaneo de puertos es el conocimiento. Esto sin duda supera al mundo del automóvil, donde puede ser necesaria una gran habilidad para determinar que se necesita un compresor de resortes de amortiguador, y luego todavía hay que pagar miles de dólares por él.

La mayoría de los tipos de análisis sólo están disponibles para usuarios privilegiados.Esto se debe a que envían y reciben paquetes sin procesar, lo que requiere acceso raíz en sistemas Unix. Se recomienda usar una cuenta de administrador en Windows, aunque Nmap a veces funciona para usuarios sin privilegios en esa plataforma cuando Npcap ya se ha cargado en el sistema operativo. Requerir privilegios de root era una limitación importante cuando se lanzó Nmap en 1997, ya que muchos usuarios sólo tenían acceso a cuentas shell compartidas. Ahora, el mundo es diferente. Las computadoras son más baratas, mucha más gente tiene acceso directo a Internet y los sistemas de escritorio Unix (incluidos Linux y Mac OS X) prevalecen. Ahora está disponible una versión de Nmap para Windows, lo que le permite ejecutarse en aún más escritorios. Por todas estas razones, los usuarios tienen menos necesidad de ejecutar Nmap desde cuentas de shell compartidas limitadas. Esto es una suerte, ya que las opciones privilegiadas hacen que Nmap sea mucho más potente y flexible.

Si bien Nmap intenta producir resultados precisos, tenga en cuenta que todos sus conocimientos se basan en los paquetes devueltos por las máquinas de destino (o los firewalls frente a ellas). Dichos hosts pueden no ser confiables y enviar respuestas destinadas a confundir o engañar a Nmap. Mucho más comunes son los hosts que no cumplen con RFC y que no responden como deberían a las sondas de Nmap. Los análisis FIN, NULL y Xmas son particularmente susceptibles a este problema. Estos problemas son específicos de determinados tipos de análisis y, por lo tanto, se analizan en las entradas de tipos de análisis individuales.

Esta sección documenta la docena de técnicas de escaneo de puertos soportadas por Nmap. Solo se puede utilizar un método a la vez, excepto que el escaneo UDP (`-sU`) y cualquiera de los tipos de escaneo SCTP (`-sY`, `-sZ`) se pueden combinar con cualquiera de los tipos de escaneo TCP. . Como ayuda para la memoria, las opciones de tipo de escaneo de puertos tienen la forma ``-s_`<C>`_``, donde _`<C>`_ es un carácter destacado en el nombre del escaneo, generalmente el primero. La única excepción a esto es el escaneo de rebote FTP obsoleto (`-b`). De forma predeterminada, Nmap realiza un escaneo SYN, aunque lo sustituye por un escaneo de conexión si el usuario no tiene los privilegios adecuados para enviar paquetes sin procesar (requiere acceso raíz en Unix). De los análisis enumerados en esta sección, los usuarios sin privilegios sólo pueden ejecutar análisis de conexión y rebote FTP.

`-sS` (TCP SYN scan)

El escaneo SYN es la opción de escaneo predeterminada y más popular por buenas razones. Se puede realizar rápidamente, escaneando miles de puertos por segundo en una red rápida que no se ve obstaculizada por firewalls restrictivos. También es relativamente discreto y sigiloso ya que nunca completa las conexiones TCP. El escaneo SYN funciona contra cualquier pila TCP compatible en lugar de depender de las idiosincrasias de plataformas específicas como lo hacen los escaneos FIN/NULL/Xmas, Maimon e inactivos de Nmap. También permite una diferenciación clara y confiable entre los estados `abierto`, `cerrado` y "filtrado".

Esta técnica a menudo se conoce como escaneo medio abierto, porque no abre una conexión TCP completa. Envía un paquete SYN, como si fuera a abrir una conexión real y luego esperar una respuesta. Un SYN/ACK indica que el puerto está escuchando (abierto), mientras que un RST (reinicio) es indicativo de que no está escuchando. Si no se recibe respuesta después de varias retransmisiones, el puerto se marca como filtrado. El puerto también se marca como filtrado si se recibe un error ICMP inalcanzable (tipo 3, código 0, 1, 2, 3, 9, 10 o 13). El puerto también se considera abierto si se recibe como respuesta un paquete SYN (sin el indicador ACK). Esto puede deberse a una característica TCP extremadamente rara conocida como conexión simultánea abierta o dividida (consulte [`https://nmap.org/misc/split-handshake.pdf`](https://nmap.org/misc /split-handshake.pdf)).

`-sT` (TCP connect scan)

La exploración de conexión TCP es el tipo de exploración TCP predeterminado cuando la exploración SYN no es una opción. Este es el caso cuando un usuario no tiene privilegios de paquetes sin formato. En lugar de escribir paquetes sin procesar como lo hacen la mayoría de los otros tipos de escaneo, Nmap le pide al sistema operativo subyacente que establezca una conexión con la máquina y el puerto de destino mediante la emisión de la llamada al sistema "connect". Esta es la misma llamada al sistema de alto nivel que utilizan los navegadores web, los clientes P2P y la mayoría de las demás aplicaciones habilitadas para la red para establecer una conexión. Es parte de una interfaz de programación conocida como Berkeley Sockets API. En lugar de leer respuestas de paquetes sin procesar, Nmap utiliza esta API para obtener información de estado en cada intento de conexión.

Cuando el escaneo SYN está disponible, suele ser una mejor opción. Nmap tiene menos control sobre la llamada "connect" de alto nivel que con los paquetes sin formato, lo que lo hace menos eficiente. La llamada al sistema completa las conexiones para abrir los puertos de destino en lugar de realizar el reinicio medio abierto que realiza el escaneo SYN. Esto no sólo lleva más tiempo y requiere más paquetes para obtener la misma información, sino que es más probable que las máquinas de destino registren la conexión. Un IDS decente detectará cualquiera de los dos, pero la mayoría de las máquinas no tienen ese sistema de alarma. Muchos servicios en su sistema Unix promedio agregarán una nota al syslog y, a veces, un mensaje de error críptico, cuando Nmap se conecta y luego cierra la conexión sin enviar datos. Los servicios verdaderamente patéticos fallan cuando esto sucede, aunque eso es poco común. Un administrador que ve varios intentos de conexión en sus registros desde un único sistema debe saber que se le ha escaneado la conexión.

`-sU` (UDP scans)

Si bien la mayoría de los servicios populares en Internet se ejecutan a través del protocolo TCP, los servicios [UDP](http://www.rfc-editor.org/rfc/rfc768.txt) están ampliamente implementados. DNS, SNMP y DHCP (puertos registrados 53, 161/162 y 67/68) son tres de los más comunes. Debido a que el escaneo UDP es generalmente más lento y difícil que TCP, algunos auditores de seguridad ignoran estos puertos. Esto es un error, ya que los servicios UDP explotables son bastante comunes y los atacantes ciertamente no ignoran todo el protocolo. Afortunadamente, Nmap puede ayudar a inventariar los puertos UDP.

El escaneo UDP se activa con la opción `-sU` . Se puede combinar con un tipo de escaneo TCP como el escaneo SYN (`-sS`) para verificar ambos protocolos durante la misma ejecución.

El escaneo UDP funciona enviando un paquete UDP a cada puerto de destino. Para algunos puertos comunes, como 53 y 161, se envía una carga útil específica del protocolo para aumentar la tasa de respuesta, pero para la mayoría de los puertos el paquete está vacío a menos que `--data`, `--data-string` o `--` Se especifican las opciones de longitud de datos. Si se devuelve un error de puerto ICMP inalcanzable (tipo 3, código 3), el puerto está `cerrado`. Otros errores de ICMP inalcanzables (tipo 3, códigos 0, 1, 2, 9, 10 o 13) marcan el puerto como "filtrado". Ocasionalmente, un servicio responderá con un paquete UDP, demostrando que está `abierto`. Si no se recibe respuesta después de las retransmisiones, el puerto se clasifica como `abierto|filtrado`. Esto significa que el puerto podría estar abierto o quizás los filtros de paquetes estén bloqueando la comunicación. La detección de versión (`-sV`) se puede utilizar para ayudar a diferenciar los puertos verdaderamente abiertos de los filtrados.

Un gran desafío con el escaneo UDP es hacerlo rápidamente. Los puertos abiertos y filtrados rara vez envían alguna respuesta, lo que deja que Nmap se agote y luego realice retransmisiones en caso de que se pierda la sonda o la respuesta. Los puertos cerrados suelen ser un problema aún mayor. Por lo general, devuelven un error de puerto ICMP inalcanzable. Pero a diferencia de los paquetes RST enviados por puertos TCP cerrados en respuesta a un SYN o escaneo de conexión, muchos hosts limitan la velocidad de los mensajes inalcanzables del puerto ICMP de forma predeterminada. Linux y Solaris son especialmente estrictos al respecto. Por ejemplo, el kernel de Linux 2.4.20 limita los mensajes de destino inaccesibles a uno por segundo (en `net/ipv4/icmp.c`).

Nmap detecta la limitación de velocidad y la ralentiza en consecuencia para evitar inundar la red con paquetes inútiles que la máquina de destino descartará. Desafortunadamente, un límite estilo Linux de un paquete por segundo hace que un análisis de 65.536 puertos demore más de 18 horas. Las ideas para acelerar sus escaneos UDP incluyen escanear más hosts en paralelo, hacer primero un escaneo rápido solo de los puertos populares, escanear desde detrás del firewall y usar `--host-timeout` para omitir hosts lentos.

`-sY` (SCTP INIT scan)

[SCTP](http://www.rfc-editor.org/rfc/rfc4960.txt) es una alternativa relativamente nueva a los protocolos TCP y UDP, que combina la mayoría de las características de TCP y UDP y también agrega nuevas características como multi- homing y multi-streaming. Se utiliza principalmente para servicios relacionados con SS7/SIGTRAN, pero tiene el potencial de usarse también para otras aplicaciones. La exploración SCTP INIT es el equivalente SCTP de una exploración TCP SYN. Se puede realizar rápidamente, escaneando miles de puertos por segundo en una red rápida que no se ve obstaculizada por firewalls restrictivos. Al igual que el escaneo SYN, el escaneo INIT es relativamente discreto y sigiloso, ya que nunca completa las asociaciones SCTP. También permite una diferenciación clara y confiable entre los estados `abierto`, `cerrado` y "filtrado".

Esta técnica a menudo se conoce como escaneo medio abierto, porque no abre una asociación SCTP completa. Envías un fragmento INIT, como si fueras a abrir una asociación real y luego esperas una respuesta. Un fragmento INIT-ACK indica que el puerto está escuchando (abierto), mientras que un fragmento ABORT indica que no está escuchando. Si no se recibe respuesta después de varias retransmisiones, el puerto se marca como filtrado. El puerto también se marca como filtrado si se recibe un error ICMP inalcanzable (tipo 3, código 0, 1, 2, 3, 9, 10 o 13).

`-sN`; `-sF`; `-sX` (TCP NULL, FIN, and Xmas scans)

Estos tres tipos de escaneo (son posibles aún más con la opción `--scanflags` que se describe en la siguiente sección) explotan una laguna sutil en el [TCP RFC](http://www.rfc-editor.org/rfc/rfc793. txt) para diferenciar entre puertos `abiertos` y `cerrados` . La página 65 del RFC 793 dice que "si el estado del puerto [de destino] está CERRADO... un segmento entrante que no contiene un RST provoca que se envíe un RST en respuesta".Luego, en la página siguiente se analizan los paquetes enviados a puertos abiertos sin los bits SYN, RST o ACK configurados, y se indica que: "es poco probable que llegue hasta aquí, pero si lo hace, abandone el segmento y regrese".

Al escanear sistemas que cumplen con este texto RFC, cualquier paquete que no contenga bits SYN, RST o ACK dará como resultado un RST devuelto si el puerto está cerrado y ninguna respuesta si el puerto está abierto. Siempre que no se incluya ninguno de esos tres bits, cualquier combinación de los otros tres (FIN, PSH y URG) está bien. Nmap aprovecha esto con tres tipos de escaneo:

Null scan (`-sN`)

No establece ningún bit (el encabezado del indicador TCP es 0)

FIN scan (`-sF`)

Establece solo el bit TCP FIN.

Xmas scan (`-sX`)

Establece las banderas FIN, PSH y URG, iluminando el paquete como un árbol de Navidad.

Estos tres tipos de escaneo tienen exactamente el mismo comportamiento, excepto por los indicadores TCP establecidos en los paquetes de sonda. Si se recibe un paquete RST, el puerto se considera `cerrado`, mientras que si no hay respuesta significa que está `abierto|filtrado`. El puerto se marca como "filtrado" si se recibe un error ICMP inalcanzable (tipo 3, código 0, 1, 2, 3, 9, 10 o 13).

La ventaja clave de estos tipos de escaneo es que pueden atravesar ciertos firewalls sin estado y enrutadores de filtrado de paquetes. Otra ventaja es que estos tipos de escaneo son un poco más sigilosos que incluso un escaneo SYN. Sin embargo, no cuente con esto: la mayoría de los productos IDS modernos se pueden configurar para detectarlos. La gran desventaja es que no todos los sistemas siguen el RFC 793 al pie de la letra. Varios sistemas envían respuestas RST a las sondas independientemente de si el puerto está abierto o no. Esto hace que todos los puertos se etiqueten como "cerrados". Los principales sistemas operativos que hacen esto son Microsoft Windows, muchos dispositivos Cisco, BSDI e IBM OS/400. Sin embargo, este análisis funciona en la mayoría de los sistemas basados ​​en Unix. Otra desventaja de estos escaneos es que no pueden distinguir los puertos "abiertos" de ciertos "filtrados", lo que le deja con la respuesta `abierto|filtrado`.

`-sA` (TCP ACK scan)

Este escaneo es diferente a los otros analizados hasta ahora en que nunca determina puertos `abiertos` (o incluso `abiertos|filtrados`). Se utiliza para mapear conjuntos de reglas de firewall, determinando si tienen estado o no y qué puertos se filtran.

El paquete de sonda de escaneo ACK solo tiene configurado el indicador ACK (a menos que use `--scanflags`). Al escanear sistemas sin filtrar, los puertos `abiertos` y `cerrados` devolverán un paquete RST. Luego, Nmap los etiqueta como `sin filtrar`, lo que significa que el paquete ACK puede acceder a ellos, pero no se determina si están `abiertos` o `cerrados`. Los puertos que no responden o devuelven ciertos mensajes de error ICMP (tipo 3, código 0, 1, 2, 3, 9, 10 o 13) se etiquetan como `filtrados`.

`-sW` (TCP Window scan)

El escaneo de ventanas es exactamente igual al escaneo ACK excepto que explota un detalle de implementación de ciertos sistemas para diferenciar los puertos abiertos de los cerrados, en lugar de imprimir siempre "sin filtrar" cuando se devuelve un RST. Para ello, examina el campo Ventana TCP de los paquetes RST devueltos. En algunos sistemas, los puertos abiertos utilizan un tamaño de ventana positivo (incluso para paquetes RST), mientras que los cerrados tienen una ventana cero. Entonces, en lugar de enumerar siempre un puerto como `sin filtrar` cuando recibe un RST, el análisis de Windows enumera el puerto como `abierto` o `cerrado` si el valor de la ventana TCP en ese reinicio es positivo o cero, respectivamente.

Este análisis se basa en detalles de implementación de una minoría de sistemas disponibles en Internet, por lo que no siempre se puede confiar en él. Los sistemas que no lo admiten normalmente devolverán todos los puertos "cerrados". Por supuesto, es posible que la máquina realmente no tenga puertos abiertos. Si la mayoría de los puertos escaneados están "cerrados", pero algunos números de puerto comunes (como 22, 25, 53) están "filtrados", lo más probable es que el sistema sea susceptible. En ocasiones, los sistemas incluso mostrarán exactamente el comportamiento opuesto. Si su escaneo muestra 1000 puertos abiertos y tres puertos cerrados o filtrados, entonces esos tres pueden ser los verdaderamente abiertos.

`-sM` (TCP Maimon scan)

El escaneo Maimon lleva el nombre de su descubridor, Uriel Maimon.Describió la técnica en el número 49 de la revista _Phrack_ (noviembre de 1996).Nmap, que incluía esta técnica, se publicó dos números más tarde. Esta técnica es exactamente la misma que los escaneos NULL, FIN y Xmas, excepto que la sonda es FIN/ACK. Según [RFC 793](http://www.rfc-editor.org/rfc/rfc793.txt) (TCP), se debe generar un paquete RST en respuesta a dicha sonda, ya sea que el puerto esté abierto o cerrado. Sin embargo, Uriel notó que muchos sistemas derivados de BSD simplemente descartan el paquete si el puerto está abierto.

`--scanflags` (Custom TCP scan)

Los usuarios de Nmap verdaderamente avanzados no necesitan limitarse a los tipos de escaneo predefinidos que se ofrecen. La opción `--scanflags` le permite diseñar su propio análisis especificando indicadores TCP arbitrarios.Deje fluir su creatividad, mientras evade los sistemas de detección de intrusiones, cuyos proveedores simplemente hojearon la página de manual de Nmap y agregaron reglas específicas.

El argumento `--scanflags` puede ser un valor de indicador numérico como 9 (PSH y FIN), pero usar nombres simbólicos es más fácil. Simplemente mezcle cualquier combinación de `URG`, `ACK`, `PSH`, `RST`, `SYN` y `FIN`. Por ejemplo, `--scanflags URGACKPSHRSTSYNFIN` configura todo, aunque no es muy útil para escanear. El orden en que se especifican es irrelevante.

Además de especificar los indicadores deseados, puede especificar un tipo de escaneo TCP (como `-sA` o `-sF`). Ese tipo base le dice a Nmap cómo interpretar las respuestas. Por ejemplo, un escaneo SYN considera que la falta de respuesta indica un puerto `filtrado` , mientras que un escaneo FIN trata lo mismo como `abierto|filtrado`. Nmap se comportará de la misma manera que para el tipo de análisis base, excepto que utilizará los indicadores TCP que usted especifique. Si no especifica un tipo base, se utiliza la exploración SYN.

`-sZ` (SCTP COOKIE ECHO scan)

El escaneo SCTP COOKIE ECHO es un escaneo SCTP más avanzado. Aprovecha el hecho de que las implementaciones SCTP deberían descartar silenciosamente paquetes que contengan fragmentos de COOKIE ECHO en puertos abiertos, pero enviar un ABORTO si el puerto está cerrado. La ventaja de este tipo de escaneo es que no es un escaneo de puerto tan obvio como un escaneo INIT. Además, puede haber conjuntos de reglas de firewall sin estado que bloqueen fragmentos INIT, pero no fragmentos de COOKIE ECHO. No se deje engañar pensando que esto hará que el escaneo de puertos sea invisible; un buen IDS también podrá detectar escaneos SCTP COOKIE ECHO. La desventaja es que los escaneos SCTP COOKIE ECHO no pueden diferenciar entre puertos `abiertos` y `filtrados` , lo que te deja con el estado ``abierto|filtrado` en ambos casos.

``-sI _`<zombie host>`_[:_`<probeport>`_]`` (idle scan)

Este método de escaneo avanzado permite un escaneo del puerto TCP verdaderamente ciego del objetivo (lo que significa que no se envían paquetes al objetivo desde su dirección IP real). En cambio, un ataque de canal lateral único aprovecha la generación predecible de secuencias de ID de fragmentación de IP en el host zombie para obtener información sobre los puertos abiertos en el objetivo. Los sistemas IDS mostrarán el escaneo como proveniente de la máquina zombie que usted especifique (que debe estar activa y cumplir con ciertos criterios). Los detalles completos de este fascinante tipo de escaneo se encuentran en [la sección llamada “TCP Idle Scan (`-sI`)”](https://nmap.org/book/idlescan.html "TCP Idle Scan (-sI)").

Además de ser extraordinariamente sigiloso (debido a su naturaleza ciega), este tipo de escaneo permite trazar relaciones de confianza basadas en IP entre máquinas. La lista de puertos muestra los puertos abiertos _desde la perspectiva del host zombie_. Por lo tanto, puede intentar escanear un objetivo utilizando varios zombies que crea que podrían ser confiables (a través de reglas de filtrado de paquetes/enrutador).

Puede agregar dos puntos seguidos de un número de puerto al host zombie si desea sondear un puerto particular en el zombie para detectar cambios de ID de IP. De lo contrario, Nmap utilizará el puerto que utiliza por defecto para los pings TCP (80).

`-sO` (IP protocol scan)

El análisis del protocolo IP le permite determinar qué protocolos IP (TCP, ICMP, IGMP, etc.) son compatibles con las máquinas de destino. Técnicamente, esto no es un escaneo de puertos, ya que recorre los números de protocolo IP en lugar de los números de puerto TCP o UDP. Sin embargo, todavía usa la opción ``-p` para seleccionar números de protocolo escaneados, informa sus resultados dentro del formato de tabla de puertos normal e incluso usa el mismo motor de escaneo subyacente que los métodos de escaneo de puertos reales. Por lo tanto, está lo suficientemente cerca de un escaneo de puertos como para pertenecer aquí.

Además de ser útil por sí solo, el escaneo de protocolos demuestra el poder del software de código abierto. Si bien la idea fundamental es bastante simple, no pensé en agregarla ni recibí ninguna solicitud para dicha funcionalidad. Luego, en el verano de 2000, Gerhard Rieger concibió la idea, escribió un excelente parche para implementarla y lo envió a la lista de correo _announce_ (entonces llamada _nmap-hackers_).Incorporé ese parche al árbol de Nmap y lancé una nueva versión al día siguiente. ¡Pocas piezas de software comercial tienen usuarios lo suficientemente entusiastas como para diseñar y contribuir con sus propias mejoras!

El escaneo de protocolo funciona de manera similar al escaneo UDP. En lugar de iterar a través del campo de número de puerto de un paquete UDP, envía encabezados de paquetes IP e itera a través del campo de protocolo IP de ocho bits. Los encabezados suelen estar vacíos y no contienen datos y ni siquiera el encabezado adecuado para el protocolo reclamado. Las excepciones son TCP, UDP, ICMP, SCTP e IGMP. Se incluye un encabezado de protocolo adecuado para ellos, ya que algunos sistemas no los enviarán de otra manera y porque Nmap ya tiene funciones para crearlos. En lugar de buscar mensajes de puerto ICMP inalcanzables, el análisis de protocolo busca mensajes ICMP _protocol_ inalcanzables. Si Nmap recibe alguna respuesta en cualquier protocolo del host de destino, Nmap marca ese protocolo como "abierto". Un error de protocolo ICMP inalcanzable (tipo 3, código 2) hace que el protocolo se marque como "cerrado", mientras que el puerto inalcanzable (tipo 3, código 3) marca el protocolo como "abierto". Otros errores de ICMP inaccesibles (tipo 3, código 0, 1, 9, 10 o 13) hacen que el protocolo se marque como "filtrado" (aunque prueban que ICMP está abierto al mismo tiempo). Si no se recibe respuesta después de las retransmisiones, el protocolo se marca como `abierto|filtrado`

``-b _`<FTP relay host>`_`` (FTP bounce scan)

Una característica interesante del protocolo FTP ([RFC 959](http://www.rfc-editor.org/rfc/rfc959.txt)) es la compatibilidad con las llamadas conexiones FTP proxy. Esto permite a un usuario conectarse a un servidor FTP y luego solicitar que los archivos se envíen a un servidor de terceros. Esta característica es propicia para el abuso en muchos niveles, por lo que la mayoría de los servidores han dejado de admitirla. Uno de los abusos que permite esta característica es hacer que el servidor FTP escanee los puertos de otros hosts. Simplemente solicite al servidor FTP que envíe un archivo a cada puerto interesante de un host de destino por turno. El mensaje de error describirá si el puerto está abierto o no. Esta es una buena manera de eludir los firewalls porque los servidores FTP de las organizaciones a menudo se ubican donde tienen más acceso a otros hosts internos que cualquier host de Internet antiguo. Nmap admite el escaneo de rebotes FTP con la opción `-b` . Toma un argumento del formato _`<nombre de usuario>`_:_`<contraseña>`_@_`<servidor>`_:_`<puerto>`_._`<Servidor>`_ es el nombre o dirección IP de un servidor FTP vulnerable. Al igual que con una URL normal, puede omitir _`<nombre de usuario>`_:_`<contraseña>`_, en cuyo caso se utilizan credenciales de inicio de sesión anónimas (usuario: `anonymous` contraseña:`-wwwuser@`). También se puede omitir el número de puerto (y los dos puntos anteriores), en cuyo caso se utiliza el puerto FTP predeterminado (21) en _`<servidor>`_ .

Esta vulnerabilidad estaba muy extendida en 1997, cuando se lanzó Nmap, pero se ha solucionado en gran medida. Todavía existen servidores vulnerables, por lo que vale la pena intentarlo cuando todo lo demás falla. Si su objetivo es evitar un firewall, escanee la red de destino en busca del puerto 21 (o incluso en busca de cualquier servicio FTP si escanea todos los puertos con detección de versión) y use el script NSE `ftp-bounce` . Nmap le dirá si el host es vulnerable o no. Si solo está tratando de cubrir sus huellas, no necesita (y, de hecho, no debería) limitarse a los hosts en la red de destino. Antes de escanear direcciones de Internet aleatorias en busca de servidores FTP vulnerables, tenga en cuenta que es posible que los administradores de sistemas no aprecien que abuse de sus servidores de esta manera.